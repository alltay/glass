<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.14.1/lodash.min.js"></script>
    </head>
    <body>

    <div id="list-complete-demo" class="demo">
      <h4>{{header}}<h4>
      <button v-on:click="shuffler" v-if="shuffle_button" class="shuffle">Перемешать</button>
      <transition-group name="list-complete" tag="p">
        <span
          v-for="item in items"
          v-bind:key="item"
          class="list-complete-item"
        >
          <transition name="fade">
              <img src="glass.png" v-if="show" class="glass" v-on:click="choose(item)" >
          </transition>
          <div v-if="show_gifts" class="gift">{{ item }}</div>
        </span>
      </transition-group>
    </div>
    <script>
        new Vue({
          el: '#list-complete-demo',
          data: {
            header: "Перемешайте стаканы",
            shuffle_button: true,
            items: [1,2,3],
            show: false,
            show_gifts: true,
            shuffled: false,
            choosen_gift: false
          },
          methods: {
            shuffler: function () {
              this.show = true;
              setTimeout(this.hider, 800);
              setTimeout(this.shuffle, 2000);
              setTimeout(this.shuffle, 2700);
              setTimeout(this.shuffle, 3400);
              setTimeout(this.shuffle, 4100);
              setTimeout(this.shuffle_block, 4800);
            },
            shuffle: function () {
              this.header = "Следите за стаканами";
              this.items = _.shuffle(this.items);
            },
            shuffle_block: function () {
              this.shuffled = true;
              this.header = "Выберите стакан";
            },
            hider: function () {
              this.shuffle_button = false;
              this.show_gifts = false;
            },
            choose: function (item) {
            	if (this.shuffled === true && this.choosen_gift === false) {
            	  this.choosen_gift = item;
                  this.header = "Ваш выигрыш: " + item;
                  this.show = false;
                  this.show_gifts = true;
                }
            },
          }
        })
    </script>
    <style>
        .glass {
           z-index: 900;
        }
        .list-complete-item {
          transition: transform 0.5s;
          display: inline-block;
        }
        .fade-enter-active, .fade-leave-active {
          transition: all 1s;
        }
        .fade-enter, .fade-leave-to {
        	transform: translateY(-150px);
        }
        .gift {
          margin-top: -40px;
          margin-left: 20px;
          width: 58px;
          height: 58px;
        }
        #list-complete-demo {
          margin: 50px auto;
          width: 500px;
        }
        .shuffle {
          position: absolute;
          margin-left: 180px;
          margin-top: -40px;
        }
    </style>
    </body>

